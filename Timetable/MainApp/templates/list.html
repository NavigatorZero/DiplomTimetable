{% block title %}Вложенный титл{% endblock %}
{% block content %}

<div class="form-group col-md-2">

    <label>Выберите дату занятий</label>

    <div class="row">
        <div class="col-md-8">


                <input type="text" class="form-control datepicker dateMain" value="{% now 'Y-m-d' %}"
                       data-date-format="yyyy-mm-dd">

        </div>
        <div class="col-md-6">
            <label for="lessonNumber">Выберите группу</label>
            <select class="form-control" id="groupNumber">
                <option value="MainTable">ПE-61</option>
                <option value="MainTableGroup2">ПЕ-62</option>
            </select>
        </div>
        <button class="btn-group-toggle" id="filters"> Применить фильтры</button>
    </div>
</div>
    <form action="{%url 'Main_list' %}" method="post">
        {% csrf_token %}
        <button type="submit" name="erase" id="erase">Стереть расписание</button>
        <button type="submit" name="fill" id="fill">Составить расписание</button>
    </form>
</div>

<div class="col-md-8 offset-2">
    {% include "main_table.html" %}
</div>
<script>
    $(document).ready(function () {
        $(".dateMain").datepicker({autoclose: true});
        var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();

        function csrfSafeMethod(method) {
            // these HTTP methods do not require CSRF protection
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $("#filters").click(function () {
            data = $('.dateMain').datepicker().val()
            group= $('#groupNumber').val()
            $.ajax({
                method: "POST",
                url: "{%url 'Main_list'%}",
                dataType: "text",
                data: {
                    "scheduleDay": data,'group':group
                },
                beforeSend: function (xhr, settings) {
                    // if not safe, set csrftoken
                    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                },
                success: function (data) {
                    $(".main_table").html(data);

                    console.log('ssucces')
                },
                error: function (er) {
                    console.log(er);
                }
            });
        });
    });
</script>
{% endblock %}